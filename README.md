```
=============================================================================================================================
Layer (type:depth-idx)                                                      Output Shape              Param #
=============================================================================================================================
MBA                                                                         [1, 4, 256, 256]          --
├─Shallow_Feature_Extractor: 1-1                                            [1, 30, 256, 256]         --
│    └─Conv2d: 2-1                                                          [1, 30, 256, 256]         300
├─Shallow_Feature_Extractor: 1-2                                            [1, 30, 256, 256]         --
│    └─Image_Reconstruction: 2-2                                            [1, 30, 256, 256]         --
│    │    └─Sequential: 3-1                                                 [1, 30, 64, 64]           1,110
│    │    └─Upsample: 3-2                                                   [1, 30, 256, 256]         65,040
│    │    └─Conv2d: 3-3                                                     [1, 30, 256, 256]         8,130
├─Deep_Feature_Extractor: 1-3                                               [1, 30, 256, 256]         60
│    └─PatchEmbed: 2-3                                                      [1, 65536, 30]            --
│    │    └─LayerNorm: 3-4                                                  [1, 65536, 30]            60
│    └─PatchEmbed: 2-4                                                      [1, 65536, 30]            --
│    │    └─LayerNorm: 3-5                                                  [1, 65536, 30]            60
│    └─Dropout: 2-5                                                         [1, 65536, 30]            --
│    └─Dropout: 2-6                                                         [1, 65536, 30]            --
│    └─ModuleList: 2-7                                                      --                        --
│    │    └─MBAG: 3-6                                                       [1, 65536, 30]            116,116
│    └─LayerNorm: 2-8                                                       [1, 65536, 30]            60
│    └─LayerNorm: 2-9                                                       [1, 65536, 30]            (recursive)
│    └─PatchUnEmbed: 2-10                                                   [1, 30, 256, 256]         --
│    └─PatchUnEmbed: 2-11                                                   [1, 30, 256, 256]         --
│    └─Conv2d: 2-12                                                         [1, 30, 256, 256]         8,130
│    └─Conv2d: 2-13                                                         [1, 30, 256, 256]         8,130
├─Image_Reconstruction: 1-4                                                 [1, 4, 256, 256]          --
│    └─Sequential: 2-14                                                     [1, 64, 256, 256]         --
│    │    └─Conv2d: 3-7                                                     [1, 64, 256, 256]         17,344
│    │    └─LeakyReLU: 3-8                                                  [1, 64, 256, 256]         --
│    └─Upsample: 2-15                                                       [1, 64, 256, 256]         --
│    └─Conv2d: 2-16                                                         [1, 4, 256, 256]          2,308
=============================================================================================================================
Total params: 226,848
Trainable params: 226,848
Non-trainable params: 0
Total mult-adds (G): 4.82
=============================================================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 2071.66
Params size (MB): 0.88
Estimated Total Size (MB): 2072.87
=============================================================================================================================
```

```
=============================================================================================================================
Layer (type:depth-idx)                                                      Output Shape              Param #
=============================================================================================================================
MBA                                                                         [1, 4, 256, 256]          --
├─Shallow_Feature_Extractor: 1-1                                            [1, 60, 256, 256]         --
│    └─Conv2d: 2-1                                                          [1, 60, 256, 256]         600
├─Shallow_Feature_Extractor: 1-2                                            [1, 60, 256, 256]         --
│    └─Image_Reconstruction: 2-2                                            [1, 60, 256, 256]         --
│    │    └─Sequential: 3-1                                                 [1, 60, 64, 64]           2,220
│    │    └─Upsample: 3-2                                                   [1, 60, 256, 256]         259,680
│    │    └─Conv2d: 3-3                                                     [1, 60, 256, 256]         32,460
├─Deep_Feature_Extractor: 1-3                                               [1, 60, 256, 256]         120
│    └─PatchEmbed: 2-3                                                      [1, 65536, 60]            --
│    │    └─LayerNorm: 3-4                                                  [1, 65536, 60]            120
│    └─PatchEmbed: 2-4                                                      [1, 65536, 60]            --
│    │    └─LayerNorm: 3-5                                                  [1, 65536, 60]            120
│    └─Dropout: 2-5                                                         [1, 65536, 60]            --
│    └─Dropout: 2-6                                                         [1, 65536, 60]            --
│    └─ModuleList: 2-7                                                      --                        --
│    │    └─MBAG: 3-6                                                       [1, 65536, 60]            456,800
│    │    └─MBAG: 3-7                                                       [1, 65536, 60]            456,800
│    └─LayerNorm: 2-8                                                       [1, 65536, 60]            120
│    └─LayerNorm: 2-9                                                       [1, 65536, 60]            (recursive)
│    └─PatchUnEmbed: 2-10                                                   [1, 60, 256, 256]         --
│    └─PatchUnEmbed: 2-11                                                   [1, 60, 256, 256]         --
│    └─Conv2d: 2-12                                                         [1, 60, 256, 256]         32,460
│    └─Conv2d: 2-13                                                         [1, 60, 256, 256]         32,460
├─Image_Reconstruction: 1-4                                                 [1, 4, 256, 256]          --
│    └─Sequential: 2-14                                                     [1, 64, 256, 256]         --
│    │    └─Conv2d: 3-8                                                     [1, 64, 256, 256]         34,624
│    │    └─LeakyReLU: 3-9                                                  [1, 64, 256, 256]         --
│    └─Upsample: 2-15                                                       [1, 64, 256, 256]         --
│    └─Conv2d: 2-16                                                         [1, 4, 256, 256]          2,308
=============================================================================================================================
Total params: 1,310,892
Trainable params: 1,310,892
Non-trainable params: 0
Total mult-adds (G): 21.24
=============================================================================================================================
Input size (MB): 0.33
Forward/backward pass size (MB): 7886.74
Params size (MB): 5.02
Estimated Total Size (MB): 7892.09
=============================================================================================================================

```
